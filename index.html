<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario de Producción JTorres</title>
</head>
<body>
  <h2>Formulario de Producción</h2>
  
  <form id="formulario">
    <label>Operario:
      <input type="text" name="operario" required>
    </label><br><br>

    <label>Referencias (separadas por coma):
      <input type="text" name="referencias">
    </label><br><br>

    <label>Cantidades (separadas por coma):
      <input type="text" name="cantidades">
    </label><br><br>

    <label>Anomalía:
      <input type="text" name="anomalia">
    </label><br><br>

    <label>Descripción de la Anomalía:
      <textarea name="descripcionAnomalia"></textarea>
    </label><br><br>

    <fieldset>
      <legend>Empaques Dañados:</legend>
      <label>Burbuja: <input type="number" name="Burbuja"></label><br>
      <label>Roto: <input type="number" name="Roto"></label><br>
      <label>Crudo: <input type="number" name="Crudo"></label><br>
      <label>Quemado: <input type="number" name="Quemado"></label><br>
      <label>Otro: <input type="number" name="Otro"></label>
    </fieldset><br>

    <button type="submit">Enviar</button>
  </form>

  <p id="respuesta"></p>

  <script>
    const form = document.getElementById("formulario");
    const respuesta = document.getElementById("respuesta");

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const formData = new FormData(form);
      const datos = {
        operario: formData.get("operario"),
        referencias: formData.get("referencias").split(",").map(s => s.trim()),
        cantidades: formData.get("cantidades").split(",").map(s => s.trim()),
        anomalia: formData.get("anomalia"),
        descripcionAnomalia: formData.get("descripcionAnomalia"),
        empaquesDañados: {
          Burbuja: formData.get("Burbuja"),
          Roto: formData.get("Roto"),
          Crudo: formData.get("Crudo"),
          Quemado: formData.get("Quemado"),
          Otro: formData.get("Otro")
        }
      };

      fetch("https://script.google.com/macros/s/AKfycbxleFNUI5cISRgZUSV_-Kdgse_DkkwT7ZL8Vse0BwkhI9GlWoUy1VUTO2TujLN6Z_7g/exec", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(datos)
      })
      .then(res => res.json())
      .then(data => {
        respuesta.textContent = data.message;
        respuesta.style.color = data.status === "success" ? "green" : "red";
      })
      .catch(err => {
        console.error("Error al enviar datos:", err);
        respuesta.textContent = "Ocurrió un error al enviar los datos.";
        respuesta.style.color = "red";
      });
    });
  </script>
</body>
</html>

